# Chatting Program

## 이 프로그램은…

Java와 TCP socket통신을 이용한 채팅 프로그램입니다.

사용자가 방을 생성할 수 있고 다른사람들이 방목록을 통해 입장이 가능합니다.

사용자가 없는 방은 자동 삭제됩니다.

눈이 편안한 녹색 계열의 채팅방입니다.

서버의 IP를 클라이언트 코드에 입력해야 사용할 수 있습니다.

## 주요기능

- 전체 채팅방(대기방)
- id 작성
- 채팅방 생성(생성 후 자동 입장)
- 채팅방 목록 확인
- 채팅방 접속

## 화면 설명

### 1. Login(로그인)

ID를 입력해 채팅시 보여질 닉네임을 설정합니다.

![01_Login](/Eunwoo/image/01_Login.png)

- Login Button : ID 창에 입력한 ID를 이용해 채팅 프로그램에 입장하게 됩니다.
    - ID에는 ‘|’ 특수기호를 이용할 수 없습니다.
    - ID의 길이는 2~10 글자만 가능합니다.
    - 다른사람과 ID 중복이 가능합니다.

### 2. Chatting Room(채팅방)

다른 이용자와 채팅할 수 있는 채팅방입니다.

![02_Chatting_room.png](/Eunwoo/image/02_Chatting_room.png)

처음엔 전체 채팅방에 입장하게 됩니다. 방에 있지 않은 사람들과 대화해보세요!

- Chatting Area : 전체채팅방에 있는 사람들의 대화가 보여집니다.
- User Information : 사용자 ID가 보여집니다.
- Room Name : 사용자가 있는 채팅방의 이름이 보여집니다.
- Room User : 채팅방에 있는 사람들의 목록이 보여집니다.
- Send Button : 왼쪽의 텍스트 박스에 있는 내용을 전송합니다.
- Move Room Button : 다른 채팅방으로 이동하는 버튼입니다.

### 3. 방 선택

다른 방을 선택할 수 있습니다.

![03_Move_Room.png](/Eunwoo/image/03_Move_Room.png)

- Select Room : 입장할 수 있는 채팅방 들을 표시합니다. 입장하고싶은 채팅방을 선택할 수 있습니다.
- Refresh Button : 채팅방 목록을 새로고침하는 버튼입니다.
- Go Room Button : Select Room 을 통해 선택한 채팅방으로 이동하는 버튼입니다.
- Create Button : 채팅방을 생성할 수 있습니다. 왼쪽의 하얀 텍스트 박스 안에 채팅방 제목을 적어주세요.
    - 채팅방 이름에는 ‘|’ 특수기호를 이용할 수 없습니다.
    - 채팅방 이름의 길이는 2~10 글자만 가능합니다.
    - 다른 채팅방과 이름 중복이 가능합니다.

## 설계

### 사용자 흐름도

![04_User_flow.png](/Eunwoo/image/04_User_flow.png)

### 화면 구성도

![05_Ui_flow.png](/Eunwoo/image/05_Ui_flow.png)

### 서버와 클라이언트간 프로토콜

- 클라이언트 → 서버
    
    
    | Type | Explanation | Id | MSG | Time |
    | --- | --- | --- | --- | --- |
    | 0 | 채팅프로그램 실행 후 입장 | My id | My id | LocalDateTime.now() |
    | 1 | 방 리스트 요청 | My id | My id | LocalDateTime.now() |
    | 2 | 방 변경 | My id | 방 번호 | LocalDateTime.now() |
    | 3 | 방 생성 | My id | 방이름 | LocalDateTime.now() |
    | 4 | 채팅 전송 | My id | My msg | LocalDateTime.now() |
    | 90 | 클라이언트 오류 | My id | 에러 msg | LocalDateTime.now() |
    | 99 | 프로그램 종료 | My id | My id | LocalDateTime.now() |
- 서버 → 클라이언트
    
    
    | Type | Explanation | Id | MSG | Time | Send to |
    | --- | --- | --- | --- | --- | --- |
    | 0 | 방 참여자 리스트 전송 | 방 번호 | 방이름|참여자목록| | 송신 시간 | 송신자 |
    | 1 | 방 리스트 전송 | 송신 id | 방번호|방이름|참가인원수| | 송신 시간 | 송신자 |
    | 2 | 방 변경 실패 | 송신 id | 에러 메시지 | 에러 시간 | 송신자 |
    | 3 | 방 생성 실패 | 송신 id | 에러 메시지 | 에러 시간 | 송신자 |
    | 4 | 채팅 전송 | 방 번호 | 송신 msg | 송신 시간 | 방 전체 |
    | 5 | 채팅방 참여 | 송신 id | 방번호|방이름|참여자목록| | 현재 시간 | 방 전체 |
    | 6 | 채팅방 나감 | 송신 id | 방번호|방이름|참여자목록| | 현재 시간 | 방 전체 |
    | 90 | 서버 오류 | 0 | 에러 msg | 현재 시간 | 송신자 |

## 회고

C언어로 제작했을때와 비교해 JAVA언어로 제작하는 것이 배열관리나 메모리 관리면에서 더 수월했다. 그러나 좀더 객체지향스럽게 코딩을 할 수 있지 않을까 하는 아쉬움이 남는 프로젝트였다. 

TCP 통신을 통해 클라이언트와 서버가 정보를 주고받아야 하므로 프로토콜이 필요했다. JSON을 이용하지 않고 String을 이용하여 프로토콜을 설계하는 부분이 생각보다 오래걸렸다. 결국 잘 사용하지 않을 ‘|’기호를 이용하여 정보를 구분하고 수동 파싱을 통해 정보를 클라이언트와 서버간 주고받을 수 있게 했다.

UI를 처음 제작해봐서 어려움이 많았다. 깔끔하고 직관적인 UI를 설계하는 것도 어려웠고 swing을 이용하여 제작하는 것이 어려웠다.  제일 당황했던 부분은 버튼에 색을 설정했더니 버튼처럼 안생겨진 부분이다. 그래서 버튼에 Button이라는 문자를 추가해버렸다.

시간 제약상 에러메시지 처리나 클라이언트의 강제종료 서버의 다운 등 다양한 처리를 넣지는 못했지만 앞으로 수정하여 더 완성도를 높일 수도 있을 것 같다.
